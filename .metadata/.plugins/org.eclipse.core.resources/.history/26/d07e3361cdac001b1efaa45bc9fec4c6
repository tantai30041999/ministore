package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import bean.User;
import db.ConnectionDB;

public class SignUpDAO {
	  public static boolean isMailExist(String email) {
	        String sql = "SELECT * from userstore  where email=?";
	        Connection con = null;
	        PreparedStatement pre = null;
	        try {
	            con = ConnectionDB.connect( );
	            pre = con.prepareStatement(sql);
	            pre.setString(1,email);
	            ResultSet rs = pre.executeQuery();
	           rs.last();
	           if(rs.getRow()>0){
	               ConnectionDB.pool.releaseConnection(con);
	               return true;
	           }

	        } catch (SQLException | ClassNotFoundException e) {
	            e.printStackTrace();
	        }
	        ConnectionDB.pool.releaseConnection(con);
	        return false;
	    }
	    public static boolean insertUser(User user) {
	        String sql = "INSERT into userstore VALUE(?,?,?,?,?,?,?,?,?,?)";
	        boolean result = false;
	        PreparedStatement pre = null;
	        Connection con = null;
	        try {
	            con = ConnectionDB.connect();
	            pre = con.prepareStatement(sql);
	            String email = user.getEmail();
	            String pass = MD5.convertHashToString(user.getPassword());
	            int level = user.getLevel();
	            int active = user.getActive();
	            pre.setString(1, email);
	            pre.setString(2, pass);
	            pre.setInt(3, level);
	            pre.setInt(4, active);

	            int add = pre.executeUpdate();
	            pre.close();

	            if (add == 1)
	                ConnectionDB.pool.releaseConnection(con);
	                result = true;
	        } catch (SQLException | ClassNotFoundException | NoSuchAlgorithmException e) {
	            e.printStackTrace();
	            ConnectionDB.pool.releaseConnection(con);
	        }
}
